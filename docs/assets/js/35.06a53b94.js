(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{458:function(t,e,a){"use strict";a.r(e);var s=a(62),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("ul",[a("li",[t._v("Title: Dumps API")]),t._v(" "),a("li",[t._v("Start Date: 2022-01-12")])]),t._v(" "),a("h1",{attrs:{id:"dumps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dumps"}},[t._v("#")]),t._v(" Dumps")]),t._v(" "),a("h2",{attrs:{id:"_1-summary"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-summary"}},[t._v("#")]),t._v(" 1. Summary")]),t._v(" "),a("p",[t._v("A dump is a compressed file containing an export of a MeiliSearch instance. It contains all indexes, documents, settings, tasks, and API keys but in a raw unprocessed form. A dump isn't an exact copy of a databaseâ€”it is closer to a blueprint that allows creating of an identical dataset.")]),t._v(" "),a("h2",{attrs:{id:"_2-motivation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-motivation"}},[t._v("#")]),t._v(" 2. Motivation")]),t._v(" "),a("p",[t._v("The dumps exist to upgrade a MeiliSearch instance from a previous version to a more recent version. It can also be a helpful tool for loading a production state on a staging server to make changes and test them before propagating them to production.")]),t._v(" "),a("h2",{attrs:{id:"_3-functional-specification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-functional-specification"}},[t._v("#")]),t._v(" 3. Functional Specification")]),t._v(" "),a("h3",{attrs:{id:"_3-1-summary-key-points"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-summary-key-points"}},[t._v("#")]),t._v(" 3.1. Summary Key Points")]),t._v(" "),a("ul",[a("li",[t._v("A dump creation can be scheduled from the MeiliSearch API using the "),a("code",[t._v("POST - /dumps")]),t._v(" endpoint.")]),t._v(" "),a("li",[t._v("A dump creation status can be tracked using the "),a("code",[t._v("GET - /dumps/{uid}/status")]),t._v(" endpoint.")]),t._v(" "),a("li",[t._v("MeiliSearch can only create one dump at a time.")]),t._v(" "),a("li",[t._v("By default, dumps are created in a folder named "),a("code",[t._v("dumps")]),t._v(", and can be found in the same directory as the MeiliSearch binary.")]),t._v(" "),a("li",[t._v("The "),a("code",[t._v("dumps")]),t._v(" directory can be customized using the "),a("code",[t._v("--dumps-dir")]),t._v(" configuration option. If the dump directory does not already exist when the dump creation process is called, MeiliSearch will create it.")]),t._v(" "),a("li",[t._v("If MeiliSearch is restarted after a dump creation, the dump's status will not appear on the "),a("code",[t._v("GET - /dumps/:uid/status")]),t._v(" endpoint.")]),t._v(" "),a("li",[t._v("A "),a("code",[t._v(".dump")]),t._v(" file can be imported using the "),a("code",[t._v("--import-dump")]),t._v(" command-line flag.")]),t._v(" "),a("li",[t._v("The MeiliSearch server starts when the dump is fully imported and indexed.")]),t._v(" "),a("li",[t._v("By default, importing a dump when a database already exists (a non-empty data.ms folder in the same directory as the MeiliSearch binary) will stop the process and throw an error.")]),t._v(" "),a("li",[t._v("When using the command-line flag "),a("code",[t._v("--ignore-dump-if-db-exists=true")]),t._v(", MeiliSearch will use the existing database to start an instance instead of throwing an error. The dump will be ignored.")]),t._v(" "),a("li",[t._v("By default, trying to import a dump that does not exist, will stop the process and throw an error.")]),t._v(" "),a("li",[t._v("When using the command-line flag "),a("code",[t._v("--ignore-missing-dump")]),t._v(", MeiliSearch will continue its process and not throw an error.")]),t._v(" "),a("li",[t._v("When a dump is being imported, the http API is not available. Meilisearch can't receive read or write requests.")]),t._v(" "),a("li",[t._v("When a dump is being created, the task queue can receive other future operations to perform later but can't process any additional tasks during the dump creation.")])]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"_3-2-dumps-api-definition"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-dumps-api-definition"}},[t._v("#")]),t._v(" 3.2. Dumps API Definition")]),t._v(" "),a("h4",{attrs:{id:"_3-2-1-post-dumps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-post-dumps"}},[t._v("#")]),t._v(" 3.2.1. POST "),a("code",[t._v("/dumps")])]),t._v(" "),a("p",[t._v("Create a dump")]),t._v(" "),a("h5",{attrs:{id:"_3-2-1-1-body-payload"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-1-body-payload"}},[t._v("#")]),t._v(" 3.2.1.1. Body Payload")]),t._v(" "),a("p",[t._v("N/A")]),t._v(" "),a("h5",{attrs:{id:"_3-2-1-2-response"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-2-response"}},[t._v("#")]),t._v(" 3.2.1.2. Response")]),t._v(" "),a("p",[a("code",[t._v("202 Accepted")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"uid"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"20220112-151751438"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"in_progress"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"startedAt"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2022-01-12T15:17:51.438881Z"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h5",{attrs:{id:"_3-2-1-3-errors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-3-errors"}},[t._v("#")]),t._v(" 3.2.1.3. Errors")]),t._v(" "),a("ul",[a("li",[t._v("ðŸ”´ If Meilisearch is secured, accessing this route without the "),a("code",[t._v("Authorization")]),t._v(" header returns a "),a("RouterLink",{attrs:{to:"/specifications/text/0061-error-format-and-definitions.html#missing_authorization_header"}},[t._v("missing_authorization_header")]),t._v(" error.")],1),t._v(" "),a("li",[t._v("ðŸ”´ If Meilisearch is secured, accessing this route with a key that does not have permissions (i.e. other than the master-key) returns an "),a("RouterLink",{attrs:{to:"/specifications/text/0061-error-format-and-definitions.html#invalid_api_key"}},[t._v("invalid_api_key")]),t._v(" error.")],1),t._v(" "),a("li",[t._v("ðŸ”´ Attempting to create a dump while a dump is already being created return an "),a("RouterLink",{attrs:{to:"/specifications/text/0061-error-format-and-definitions.html#dump_already_in_progress"}},[t._v("dump_already_in_progress")]),t._v(" error.")],1)]),t._v(" "),a("h4",{attrs:{id:"_3-2-2-get-dumps-dump-uid-status"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-get-dumps-dump-uid-status"}},[t._v("#")]),t._v(" 3.2.2  GET "),a("code",[t._v("/dumps/:dump_uid/status")])]),t._v(" "),a("p",[t._v("Get a dump status")]),t._v(" "),a("h5",{attrs:{id:"_3-2-2-1-response"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-1-response"}},[t._v("#")]),t._v(" 3.2.2.1. Response")]),t._v(" "),a("p",[a("code",[t._v("200 Success")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"uid"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"20220112-151751438"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"in_progress"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"startedAt"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2022-01-12T15:17:51.438881Z"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h5",{attrs:{id:"_3-2-2-2-errors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-2-errors"}},[t._v("#")]),t._v(" 3.2.2.2. Errors")]),t._v(" "),a("ul",[a("li",[t._v("ðŸ”´ If Meilisearch is secured, accessing this route without the "),a("code",[t._v("Authorization")]),t._v(" header returns a "),a("RouterLink",{attrs:{to:"/specifications/text/0061-error-format-and-definitions.html#missing_authorization_header"}},[t._v("missing_authorization_header")]),t._v(" error.")],1),t._v(" "),a("li",[t._v("ðŸ”´ If Meilisearch is secured, accessing this route with a key that does not have permissions (i.e. other than the master-key) returns an "),a("RouterLink",{attrs:{to:"/specifications/text/0061-error-format-and-definitions.html#invalid_api_key"}},[t._v("invalid_api_key")]),t._v(" error.")],1),t._v(" "),a("li",[t._v("ðŸ”´ Attempting to access a dump details that does not exist returns a "),a("RouterLink",{attrs:{to:"/specifications/text/0061-error-format-and-definitions.html#dump_not_found"}},[t._v("dump_not_found")]),t._v(" error.")],1)]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"_3-3-cli-definition"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-cli-definition"}},[t._v("#")]),t._v(" 3.3. CLI Definition")]),t._v(" "),a("h4",{attrs:{id:"_3-3-1-dumps-dir"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-1-dumps-dir"}},[t._v("#")]),t._v(" 3.3.1. "),a("code",[t._v("--dumps-dir")])]),t._v(" "),a("p",[t._v("By default, MeiliSearch creates dumps in a directory called "),a("code",[t._v("dumps")]),t._v(" at the root of your MeiliSearch.")]),t._v(" "),a("p",[t._v("The destination can be modified with the "),a("code",[t._v("--dumps-dir")]),t._v(" flag. e.g. "),a("code",[t._v("--dumps-dir myDumps")])]),t._v(" "),a("h4",{attrs:{id:"_3-3-2-import-dump"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-2-import-dump"}},[t._v("#")]),t._v(" 3.3.2. "),a("code",[t._v("--import-dump")])]),t._v(" "),a("p",[t._v("Using the CLI flag "),a("code",[t._v("--import-dump")]),t._v(", MeiliSearch will replace the data.ms with the dump data and start the server using the provided dump. e.g. "),a("code",[t._v("--import-dump dumps/20220117-144855452.dump")]),t._v(".")]),t._v(" "),a("p",[t._v("If the "),a("code",[t._v("--import-dump")]),t._v(" flag is specified when a database exists, an error occurs in the CLI.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Error: database already exists at ":pathToDataMs/data.ms", try to delete it or rename it\n')])])]),a("h4",{attrs:{id:"_3-3-3-ignore-dump-if-db-exists"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-3-ignore-dump-if-db-exists"}},[t._v("#")]),t._v(" 3.3.3. "),a("code",[t._v("--ignore-dump-if-db-exists")])]),t._v(" "),a("p",[t._v("To avoid MeiliSearch to throw an error when finding that a database already exists, the following flag: "),a("code",[t._v("--ignore-dump-if-db-exists")]),t._v(" can be used. When using this flag, MeiliSearch will use the existing database to start an instance instead of throwing an error. The dump will be ignored.")]),t._v(" "),a("h4",{attrs:{id:"_3-3-4-ignore-missing-dump"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-4-ignore-missing-dump"}},[t._v("#")]),t._v(" 3.3.4. "),a("code",[t._v("--ignore-missing-dump")])]),t._v(" "),a("p",[t._v("To avoid MeiliSearch to throw an error when there is no dump at the given path, the following flag: "),a("code",[t._v("--ignore-missing-dump")]),t._v(" can be used. MeiliSearch will then continue its process and not import any dump.")]),t._v(" "),a("p",[t._v("If the "),a("code",[t._v("--ignore-missing-dump")]),t._v(" flag is not specified and the file cannot be found, an error occurs in the CLI.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Error: dump doesn\'t exist at ":pathToDumps/:missingFile"\n')])])]),a("hr"),t._v(" "),a("h3",{attrs:{id:"_3-4-dump-version-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-dump-version-support"}},[t._v("#")]),t._v(" 3.4. Dump version support")]),t._v(" "),a("p",[t._v("To handle dump and Meilisearch version compatibility, it is necessary to also versionize the dumps feature.")]),t._v(" "),a("p",[t._v("The following table describes which version of the dump correspond to which version of Meilisearch")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Dump version")]),t._v(" "),a("th",[t._v("Meilisearch version")]),t._v(" "),a("th",[t._v("Highest compatibility dump version")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v("v1")])]),t._v(" "),a("td",[a("code",[t._v("v0.20.0")]),t._v(" and below")]),t._v(" "),a("td",[a("code",[t._v("v3")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("v2")])]),t._v(" "),a("td",[a("code",[t._v("v0.21.0")]),t._v(" and "),a("code",[t._v("v0.21.1")])]),t._v(" "),a("td",[a("code",[t._v("v4")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("v3")])]),t._v(" "),a("td",[t._v("From "),a("code",[t._v("v0.22.0")]),t._v(" to "),a("code",[t._v("v0.24.0")]),t._v(" included")]),t._v(" "),a("td",[a("code",[t._v("v4")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("v4")])]),t._v(" "),a("td",[a("code",[t._v("v0.25.0")]),t._v(" and later")]),t._v(" "),a("td",[t._v("-")])])])]),t._v(" "),a("p",[t._v('What does "Highest compatibility dump version" means?\nFor maintainance reasons, we cannot guarantee the compatibility from old dump versions to the newest ones.\nConcretely, if the user wants to upgrade from Meilisearch '),a("code",[t._v("v0.19.0")]),t._v(" (dump "),a("code",[t._v("v1")]),t._v(") to "),a("code",[t._v("v0.26.0")]),t._v(" (dump "),a("code",[t._v("v4")]),t._v("), migration should be done in two steps. First, import your "),a("code",[t._v("v0.19.0")]),t._v(" dump into an instance running any version of Meilisearch between v0.21 and v0.24. Second, export another dump from this instance and import it to a final instance running with "),a("code",[t._v("v0.26.0")]),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"_2-technical-aspects"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-technical-aspects"}},[t._v("#")]),t._v(" 2. Technical Aspects")]),t._v(" "),a("h3",{attrs:{id:"_2-1-dump-creation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-dump-creation"}},[t._v("#")]),t._v(" 2.1. Dump Creation")]),t._v(" "),a("p",[t._v("When a dump is being created, the task queue can receive other future operations to perform later but can't process any additional tasks during the dump creation.")]),t._v(" "),a("h3",{attrs:{id:"_2-2-importing-a-dump"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-importing-a-dump"}},[t._v("#")]),t._v(" 2.2. Importing a dump")]),t._v(" "),a("p",[t._v("When a dump is being imported, the http API is not available. Meilisearch can't receive read or write requests.")]),t._v(" "),a("h2",{attrs:{id:"_3-future-possibilities"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-future-possibilities"}},[t._v("#")]),t._v(" 3. Future Possibilities")]),t._v(" "),a("ul",[a("li",[t._v("Make dump creation a "),a("code",[t._v("task")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);